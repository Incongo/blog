<h1 class="mb-4">Publicaciones</h1>

<a href="/publicaciones/crear" class="btn btn-primary mb-4">Crear nueva publicación</a>

<ul class="post-list">
    <% publicaciones.forEach(pub=> { %>
        <li class="post-card" onclick="window.location='/publicaciones/<%= pub.id_publicacion %>'">

            <!-- HEADER: Avatar + Nombre -->
            <div class="post-header">
                <img src="<%= pub.usuario.foto_perfil || '/img/default-avatar.png' %>" class="post-avatar">

                <div>
                    <a href="/usuario/<%= pub.usuario.id_usuario %>" class="post-author">
                        <i class="bi bi-person-circle"></i>
                        <%= pub.usuario.nombre %>
                    </a>
                </div>

            </div>

            <!-- TÍTULO -->
            <a href="/publicaciones/<%= pub.id_publicacion %>" class="post-title">
                <%= pub.titulo %>
            </a>

            <!-- PREVIEW -->
            <p class="post-preview">
                <%= pub.contenido.substring(0, 120) %>...
            </p>

            <!-- META -->
            <div class="post-meta">

                <span><i class="bi bi-clock"></i>
                    <%= pub.fecha_publicacion.toLocaleDateString() %>
                </span>
                <button class="like-btn" onclick="event.stopPropagation(); like(<%= pub.id_publicacion %>, this)">
                    <i class="bi bi-hand-thumbs-up"></i>
                    <span>
                        <%= (pub.megusta_publicacion || []).length %>
                    </span>
                </button>

                </button>

            </div>

        </li>
        <% }) %>
</ul>